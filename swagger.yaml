openapi: 3.0.0
info:
  title: Gestor Financiero IA API
  version: 2.0.0
  description: |
    API avanzada con 20 caracter铆sticas de Inteligencia Artificial para gesti贸n financiera personal.
    
    ##  Caracter铆sticas Principales
    
    ###  PREDICCIN DE GASTOS (5 mejoras)
    1. Predicci贸n por categor铆a
    2. Predicci贸n mensual (30 d铆as)
    3. Detecci贸n de anomal铆as
    4. M煤ltiples modelos ML (ARIMA, Prophet, LSTM)
    5. An谩lisis de estacionalidad
    
    ###  ANLISIS ESTADSTICO (5 mejoras)
    6. Correlaciones entre categor铆as
    7. An谩lisis temporal (mes actual vs anterior)
    8. Clustering autom谩tico de gastos
    9. Detecci贸n de tendencias
    10. Identificaci贸n de outliers (IQR + Z-Score)
    
    ###  RECOMENDACIONES DE AHORRO (5 mejoras)
    11. Metas de ahorro (objetivos espec铆ficos)
    12. Tips personalizados (basados en patrones)
    13. Alertas de presupuesto (l铆mites mensuales)
    14. Gamificaci贸n (puntuaci贸n financiera)
    15. Reportes autom谩ticos (resumen semanal)
    
    ###  GRFICOS Y VISUALIZACIN (5 mejoras)
    16. Calendario de calor (Heatmap de gastos)
    17. Gr谩fico Sankey (Flujo de dinero)
    18. Dashboard interactivo (Panel con filtros)
    19. Comparativas (Mes vs mes anterior)
    20. Exportar como imagen (PNG/PDF)
    
    ##  Autenticaci贸n
    
    Todos los endpoints (excepto `/auth/token` y `/health`) requieren autenticaci贸n mediante JWT.
    
    **Paso 1:** Obtener token en `/api/v2/auth/token`
    
    **Paso 2:** Incluir token en headers:
    - `Authorization: Bearer {token}` o
    - `X-API-Key: {token}`

servers:
  - url: https://tu-api.onrender.com
    description: Servidor de producci贸n
  - url: http://localhost:5000
    description: Servidor de desarrollo local

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
  
  schemas:
    Expense:
      type: object
      required:
        - fecha
        - monto
        - categoria
      properties:
        fecha:
          type: string
          format: date
          example: "2024-12-15"
        monto:
          type: number
          format: float
          example: 150.50
        categoria:
          type: string
          example: "Comida"
    
    ExpensesRequest:
      type: object
      properties:
        expenses:
          type: array
          items:
            $ref: '#/components/schemas/Expense'
          description: "Lista de gastos (opcional si se usa Firebase)"
    
    TokenRequest:
      type: object
      properties:
        user_id:
          type: string
          example: "usuario123"
          default: "default_user"
    
    TokenResponse:
      type: object
      properties:
        status:
          type: string
          example: "success"
        token:
          type: string
          example: "eyJ0eXAiOiJKV1QiLCJhbGc..."
        expires_in:
          type: integer
          example: 86400
        message:
          type: string
        instrucciones:
          type: string
    
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "Token inv谩lido o expirado"

security:
  - BearerAuth: []
  - ApiKeyAuth: []

paths:
  /api/v2/auth/token:
    post:
      tags:
        - Autenticaci贸n
      summary: Generar token JWT
      description: Genera un nuevo token JWT para acceder a los endpoints protegidos
      security: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRequest'
      responses:
        '200':
          description: Token generado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
              example:
                status: "success"
                token: "eyJ0eXAiOiJKV1QiLCJhbGc..."
                expires_in: 86400
                message: "Token generado para usuario123. V谩lido por 24 horas"
                instrucciones: "Usar en headers: Authorization: Bearer <token> o X-API-Key: <token>"

  /api/v2/auth/validate:
    post:
      tags:
        - Autenticaci贸n
      summary: Validar token
      description: Verifica si un token JWT es v谩lido
      security: []
      responses:
        '200':
          description: Resultado de validaci贸n
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                  message:
                    type: string
              example:
                valid: true
                message: "Token v谩lido"

  /api/v2/health:
    get:
      tags:
        - Utilidades
      summary: Estado de la API
      description: Verifica el estado de la API y sus servicios
      security: []
      responses:
        '200':
          description: Estado de la API
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  timestamp:
                    type: string
                  firebase:
                    type: boolean
                  modelos_disponibles:
                    type: object
              example:
                status: "ok"
                timestamp: "2024-12-15T10:30:00"
                firebase: true
                modelos_disponibles:
                  arima: true
                  prophet: true
                  lstm: false

  /api/v2/predict-category:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: Predicci贸n por categor铆a
      description: |
        Predice gastos separados para cada categor铆a para los pr贸ximos 30 d铆as.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/predict-category`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** 
        - `expenses` (opcional): Array de gastos. Si se omite, se obtienen de Firebase usando el user_id del token.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Predicciones generadas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  data:
                    type: object
              example:
                status: "success"
                data:
                  Comida:
                    predicciones:
                      - fecha: "2024-12-16"
                        monto: 85.50
                      - fecha: "2024-12-17"
                        monto: 92.30
                    total: 2556.00
                    promedio_diario: 85.20
                  Transporte:
                    predicciones:
                      - fecha: "2024-12-16"
                        monto: 35.00
                    total: 1050.00
                    promedio_diario: 35.00

  /api/v2/predict-monthly:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: Predicci贸n mensual (30 d铆as)
      description: |
        Predice gastos para los pr贸ximos 30 d铆as con intervalos de confianza.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/predict-monthly`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Predicci贸n mensual generada
          content:
            application/json:
              example:
                status: "success"
                data:
                  diarias:
                    - fecha: "2024-12-16"
                      dia_semana: "Monday"
                      semana: 1
                      prediccion: 120.50
                      min: 80.30
                      max: 160.70
                  total_mes: 3615.00
                  promedio_diario: 120.50
                  resumen_semanal:
                    1:
                      total: 843.50
                      promedio_diario: 120.50

  /api/v2/detect-anomalies:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: Detecci贸n de anomal铆as
      description: |
        Detecta gastos an贸malos usando Z-Score e Isolation Forest.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/detect-anomalies`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Anomal铆as detectadas
          content:
            application/json:
              example:
                status: "success"
                data:
                  cantidad: 3
                  anomalias:
                    - fecha: "2024-12-10"
                      monto: 850.00
                      categoria: "Compras"
                      metodo: "Z-Score"
                      razon: "Desviaci贸n 3.45 del promedio"
                  porcentaje: 5.26

  /api/v2/compare-models:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: Comparaci贸n de modelos ML
      description: |
        Entrena y compara m煤ltiples modelos de Machine Learning (RandomForest, ARIMA, ExponentialSmoothing).
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/compare-models`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Comparaci贸n de modelos completada
          content:
            application/json:
              example:
                status: "success"
                data:
                  modelos: ["RandomForest", "ARIMA", "ExponentialSmoothing"]
                  resultados:
                    RandomForest:
                      mae: 15.32
                      r2: 0.8756
                      modelo: "RandomForest"
                    ARIMA:
                      mae: 18.45
                      r2: 0.8234
                      modelo: "ARIMA"
                  mejor: "RandomForest"
                  mejor_r2: 0.8756

  /api/v2/seasonality:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: An谩lisis de estacionalidad
      description: |
        Detecta patrones semanales y mensuales en los gastos.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/seasonality`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: An谩lisis de estacionalidad completado

  /api/v2/analysis-complete:
    post:
      tags:
        -  Predicci贸n de Gastos
      summary: An谩lisis completo de predicci贸n
      description: |
        Ejecuta todas las 5 mejoras de predicci贸n en un solo endpoint.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/analysis-complete`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: An谩lisis completo generado
          content:
            application/json:
              example:
                status: "success"
                data:
                  prediccion_categoria: {}
                  prediccion_mensual: {}
                  anomalias: {}
                  comparacion_modelos: {}
                  estacionalidad: {}
                  timestamp: "2024-12-15T10:30:00"

  /api/v2/stat/correlations:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: Correlaciones entre categor铆as
      description: |
        Analiza correlaciones entre diferentes categor铆as de gastos.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/correlations`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Correlaciones calculadas

  /api/v2/stat/temporal-comparison:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: Comparaci贸n temporal
      description: |
        Compara gastos del mes actual vs mes anterior.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/temporal-comparison`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Comparaci贸n temporal generada

  /api/v2/stat/clustering:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: Clustering de gastos
      description: |
        Agrupa autom谩ticamente gastos similares usando K-Means.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/clustering`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `n_clusters` (opcional): N煤mero de clusters (default: 3)
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                n_clusters:
                  type: integer
                  example: 3
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: Clustering completado

  /api/v2/stat/trends:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: Detecci贸n de tendencias
      description: |
        Detecta tendencias en los patrones de gasto.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/trends`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Tendencias detectadas

  /api/v2/stat/outliers:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: Detecci贸n de outliers
      description: |
        Detecta gastos at铆picos usando IQR y Z-Score.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/outliers`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Outliers detectados

  /api/v2/stat/complete:
    post:
      tags:
        -  An谩lisis Estad铆stico
      summary: An谩lisis estad铆stico completo
      description: |
        Ejecuta todas las 5 mejoras de an谩lisis estad铆stico en un solo endpoint.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/stat/complete`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: An谩lisis completo generado

  /api/v2/savings/goals:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: Metas de ahorro
      description: |
        Calcula metas de ahorro personalizadas basadas en objetivos espec铆ficos.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/goals`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `goal_name`: Nombre de la meta (default: "Meta general")
        - `target_amount`: Monto objetivo (default: 5000)
        - `months`: Meses para alcanzar la meta (default: 12)
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                goal_name:
                  type: string
                  example: "Vacaciones"
                target_amount:
                  type: number
                  example: 5000
                months:
                  type: integer
                  example: 12
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: Metas calculadas

  /api/v2/savings/tips:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: Tips personalizados
      description: |
        Genera tips de ahorro personalizados basados en patrones de gasto.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/tips`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Tips generados

  /api/v2/savings/budget-alerts:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: Alertas de presupuesto
      description: |
        Genera alertas cuando se acerca o supera el presupuesto mensual.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/budget-alerts`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `monthly_budget`: Presupuesto mensual (default: 3000)
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                monthly_budget:
                  type: number
                  example: 3000
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: Alertas generadas

  /api/v2/savings/health-score:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: Puntuaci贸n financiera
      description: |
        Calcula una puntuaci贸n de salud financiera (0-100).
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/health-score`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `monthly_budget`: Presupuesto mensual (default: 3000)
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                monthly_budget:
                  type: number
                  example: 3000
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: Puntuaci贸n calculada

  /api/v2/savings/weekly-report:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: Reporte semanal
      description: |
        Genera un resumen autom谩tico de gastos de la 煤ltima semana.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/weekly-report`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Reporte generado

  /api/v2/savings/complete:
    post:
      tags:
        -  Recomendaciones de Ahorro
      summary: An谩lisis completo de ahorro
      description: |
        Ejecuta todas las 5 mejoras de recomendaciones de ahorro en un solo endpoint.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/savings/complete`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `goal_name`, `target_amount`, `months`, `monthly_budget`
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                goal_name:
                  type: string
                target_amount:
                  type: number
                months:
                  type: integer
                monthly_budget:
                  type: number
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: An谩lisis completo generado

  /api/v2/charts/heatmap:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Calendario de calor
      description: |
        Genera un calendario de calor (heatmap) de gastos.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/heatmap`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Heatmap generado

  /api/v2/charts/sankey:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Diagrama Sankey
      description: |
        Genera un diagrama Sankey del flujo de dinero entre categor铆as.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/sankey`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Diagrama Sankey generado

  /api/v2/charts/dashboard:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Dashboard interactivo
      description: |
        Genera un dashboard interactivo con m煤ltiples gr谩ficos.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/dashboard`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Dashboard generado

  /api/v2/charts/comparison:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Comparaci贸n mensual
      description: |
        Genera gr谩ficos comparativos mes vs mes anterior.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/comparison`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Comparaci贸n generada

  /api/v2/charts/export:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Exportar gr谩ficos
      description: |
        Exporta gr谩ficos como im谩genes en formato JSON o BASE64.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/export`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `format`: "json" o "base64" (default: "json")
        - `expenses` (opcional): Array de gastos
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                format:
                  type: string
                  enum: ["json", "base64"]
                  example: "json"
                expenses:
                  type: array
                  items:
                    $ref: '#/components/schemas/Expense'
      responses:
        '200':
          description: Gr谩ficos exportados

  /api/v2/charts/complete:
    post:
      tags:
        -  Gr谩ficos y Visualizaci贸n
      summary: Todos los gr谩ficos
      description: |
        Genera todos los 5 tipos de gr谩ficos en un solo endpoint.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/charts/complete`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** Ninguno (usa datos de Firebase) o `expenses` array
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpensesRequest'
      responses:
        '200':
          description: Todos los gr谩ficos generados

  /api/v2/firebase/users/{usuario_id}/gastos:
    get:
      tags:
        -  Firebase Integration
      summary: Obtener gastos del usuario
      description: |
        Obtiene todos los gastos registrados de un usuario desde Firebase.
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/gastos`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:** 
        - `usuario_id` (path): ID del usuario en Firebase
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gastos obtenidos exitosamente
    
    post:
      tags:
        -  Firebase Integration
      summary: Crear nuevo gasto
      description: |
        Crea un nuevo gasto en Firebase para el usuario especificado.
        
        ** Endpoint:** `POST https://tu-api.com/api/v2/firebase/users/{usuario_id}/gastos`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `usuario_id` (path): ID del usuario
        - Body: datos del gasto (categoria, cantidad, fecha, descripcion)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - categoria
                - cantidad
              properties:
                categoria:
                  type: string
                  example: "Comida"
                cantidad:
                  type: number
                  example: 150.50
                descripcion:
                  type: string
                  example: "Almuerzo"
                fecha:
                  type: string
                  format: date-time
      responses:
        '201':
          description: Gasto creado exitosamente

  /api/v2/firebase/users/{usuario_id}/asesor-financiero:
    get:
      tags:
        -  Asesor Financiero IA
      summary: An谩lisis completo con IA
      description: |
        Devuelve an谩lisis integral del usuario con IA incluyendo:
        - Predicciones de gastos futuros (30 d铆as)
        - An谩lisis estad铆stico completo
        - Recomendaciones personalizadas de ahorro
        - Datos para gr谩ficos
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/asesor-financiero`
        
        ** Requiere:** Token de autenticaci贸n
        
        ** Par谩metros:**
        - `usuario_id` (path): ID del usuario en Firebase
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An谩lisis completo generado

  /api/v2/firebase/users/{usuario_id}/predicciones:
    get:
      tags:
        -  Asesor Financiero IA
      summary: Predicciones para usuario
      description: |
        Obtiene todas las predicciones de gastos para un usuario espec铆fico.
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/predicciones`
        
        ** Requiere:** Token de autenticaci贸n
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Predicciones generadas

  /api/v2/firebase/users/{usuario_id}/analisis:
    get:
      tags:
        -  Asesor Financiero IA
      summary: An谩lisis estad铆stico para usuario
      description: |
        Obtiene an谩lisis estad铆stico completo para un usuario espec铆fico.
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/analisis`
        
        ** Requiere:** Token de autenticaci贸n
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An谩lisis generado

  /api/v2/firebase/users/{usuario_id}/recomendaciones:
    get:
      tags:
        -  Asesor Financiero IA
      summary: Recomendaciones para usuario
      description: |
        Obtiene recomendaciones personalizadas de ahorro para un usuario.
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/recomendaciones`
        
        ** Requiere:** Token de autenticaci贸n
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Recomendaciones generadas

  /api/v2/firebase/users/{usuario_id}/graficos:
    get:
      tags:
        -  Asesor Financiero IA
      summary: Gr谩ficos para usuario
      description: |
        Genera todos los gr谩ficos para un usuario espec铆fico.
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/graficos`
        
        ** Requiere:** Token de autenticaci贸n
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr谩ficos generados

  /api/v2/firebase/users/{usuario_id}/score:
    get:
      tags:
        -  Asesor Financiero IA
      summary: Puntuaci贸n financiera del usuario
      description: |
        Calcula la puntuaci贸n de salud financiera del usuario (0-100).
        
        ** Endpoint:** `GET https://tu-api.com/api/v2/firebase/users/{usuario_id}/score`
        
        ** Requiere:** Token de autenticaci贸n
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Puntuaci贸n calculada
