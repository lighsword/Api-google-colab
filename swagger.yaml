openapi: 3.0.0
info:
  title: Gestor Financiero IA API
  version: 2.0.0
  description: |
    API avanzada con 20 caracter칤sticas de Inteligencia Artificial para gesti칩n financiera personal.
    
    **Endpoints totales: 65 endpoints disponibles**
    
    ## 游 Caracter칤sticas Principales
    
    ### 游늵 PREDICCI칍N DE GASTOS (5 mejoras)
    1. Predicci칩n por categor칤a
    2. Predicci칩n mensual (30 d칤as)
    3. Detecci칩n de anomal칤as
    4. M칰ltiples modelos ML
    5. An치lisis de estacionalidad
    
    ### 游늳 AN츼LISIS ESTAD칈STICO (5 mejoras)
    6. Correlaciones entre categor칤as
    7. An치lisis temporal (mes actual vs anterior)
    8. Clustering de gastos
    9. Detecci칩n de tendencias
    10. Identificaci칩n de outliers
    
    ### 游눠 RECOMENDACIONES DE AHORRO (5 mejoras)
    11. Metas de ahorro
    12. Tips personalizados
    13. Alertas de presupuesto
    14. Puntuaci칩n financiera
    15. Reportes autom치ticos
    
    ### 游늵 GR츼FICOS Y VISUALIZACI칍N (5 mejoras)
    16. Heatmap de gastos
    17. Diagrama Sankey
    18. Dashboard interactivo
    19. Comparativa mensual
    20. Exportar como imagen
    
    ## 游댏 Autenticaci칩n
    Todos los endpoints requieren JWT token en headers:
    - `Authorization: Bearer {token}` o
    - `X-API-Key: {token}`

servers:
  - url: https://api-google-colab.onrender.com
    description: Servidor de producci칩n
  - url: http://localhost:5000
    description: Servidor de desarrollo

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

paths:
  /api/v2/auth/token:
    post:
      tags:
        - Autenticaci칩n
      summary: Generar token JWT
      description: Genera un token v치lido por 24 horas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: string
      responses:
        '200':
          description: Token generado

  /:
    get:
      tags:
        - Utilidades
      summary: Informaci칩n de la API
      responses:
        '200':
          description: Info general

  /api/v2/swagger.yaml:
    get:
      tags:
        - Utilidades
      summary: Especificaci칩n OpenAPI
      responses:
        '200':
          description: Especificaci칩n YAML

  /api/v2/firebase/debug:
    get:
      tags:
        - Utilidades
      summary: Estado de Firebase
      responses:
        '200':
          description: Estado

  /api/v2/firebase/usuarios:
    get:
      tags:
        - Usuarios
      summary: Listar usuarios
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Lista de usuarios

  /api/v2/firebase/usuarios/{usuario_id}:
    get:
      tags:
        - Usuarios
      summary: Obtener usuario
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Usuario encontrado

  /api/v2/firebase/users/{usuario_id}/gastos:
    get:
      tags:
        - Gastos
      summary: Obtener gastos
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gastos del usuario

    post:
      tags:
        - Gastos
      summary: Crear gasto
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                monto:
                  type: number
                categoria:
                  type: string
      security:
        - BearerAuth: []
      responses:
        '201':
          description: Gasto creado

  /api/v2/firebase/users/{usuario_id}/gastos-procesados:
    get:
      tags:
        - Gastos
      summary: Gastos procesados
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gastos procesados

  /api/v2/firebase/users/{usuario_id}/gastos-ids:
    get:
      tags:
        - Gastos
      summary: IDs de gastos
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: IDs de gastos

  /api/v2/predict-category:
    get:
      tags:
        - Predicci칩n
      summary: Predicci칩n por categor칤a
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Predicci칩n

  /api/v2/predict-monthly:
    get:
      tags:
        - Predicci칩n
      summary: Predicci칩n mensual
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Predicci칩n

  /api/v2/detect-anomalies:
    get:
      tags:
        - Predicci칩n
      summary: Detecci칩n de anomal칤as
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Anomal칤as encontradas

  /api/v2/compare-models:
    get:
      tags:
        - Predicci칩n
      summary: Comparaci칩n de modelos
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n

  /api/v2/seasonality:
    get:
      tags:
        - Predicci칩n
      summary: An치lisis de estacionalidad
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/analysis-complete:
    get:
      tags:
        - Predicci칩n
      summary: An치lisis completo de predicci칩n
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/users/{usuario_id}/predict-category:
    get:
      tags:
        - Predicci칩n Personalizada
      summary: Predicci칩n por categor칤a (usuario)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Predicci칩n del usuario

  /api/v2/users/{usuario_id}/predict-monthly:
    get:
      tags:
        - Predicci칩n Personalizada
      summary: Predicci칩n mensual (usuario)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Predicci칩n del usuario

  /api/v2/users/{usuario_id}/detect-anomalies:
    get:
      tags:
        - Predicci칩n Personalizada
      summary: Anomal칤as (usuario)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Anomal칤as del usuario

  /api/v2/users/{usuario_id}/analysis-complete:
    get:
      tags:
        - Predicci칩n Personalizada
      summary: An치lisis completo (usuario)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis del usuario

  /api/v2/firebase/users/{usuario_id}/compare-models:
    get:
      tags:
        - Predicci칩n Firebase
      summary: Comparaci칩n de modelos (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n

  /api/v2/firebase/users/{usuario_id}/seasonality:
    get:
      tags:
        - Predicci칩n Firebase
      summary: Estacionalidad (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/stat/correlations:
    get:
      tags:
        - Estad칤stica
      summary: Correlaciones
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Correlaciones

  /api/v2/stat/temporal-comparison:
    get:
      tags:
        - Estad칤stica
      summary: Comparaci칩n temporal
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n

  /api/v2/stat/clustering:
    get:
      tags:
        - Estad칤stica
      summary: Clustering
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Clustering

  /api/v2/stat/trends:
    get:
      tags:
        - Estad칤stica
      summary: Tendencias
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tendencias

  /api/v2/stat/outliers:
    get:
      tags:
        - Estad칤stica
      summary: Outliers
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Outliers

  /api/v2/stat/complete:
    get:
      tags:
        - Estad칤stica
      summary: An치lisis estad칤stico completo
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis completo

  /api/v2/firebase/users/{usuario_id}/stat/correlations:
    get:
      tags:
        - Estad칤stica Firebase
      summary: Correlaciones (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Correlaciones

  /api/v2/firebase/users/{usuario_id}/stat/temporal-comparison:
    get:
      tags:
        - Estad칤stica Firebase
      summary: Comparaci칩n temporal (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n

  /api/v2/firebase/users/{usuario_id}/stat/clustering:
    get:
      tags:
        - Estad칤stica Firebase
      summary: Clustering (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Clustering

  /api/v2/firebase/users/{usuario_id}/stat/trends:
    get:
      tags:
        - Estad칤stica Firebase
      summary: Tendencias (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tendencias

  /api/v2/firebase/users/{usuario_id}/stat/outliers:
    get:
      tags:
        - Estad칤stica Firebase
      summary: Outliers (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Outliers

  /api/v2/firebase/users/{usuario_id}/stat/complete:
    get:
      tags:
        - Estad칤stica Firebase
      summary: An치lisis completo (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/savings/goals:
    get:
      tags:
        - Ahorros
      summary: Metas de ahorro
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Metas
    post:
      tags:
        - Ahorros
      summary: Crear meta
      security:
        - BearerAuth: []
      responses:
        '201':
          description: Meta creada

  /api/v2/savings/tips:
    get:
      tags:
        - Ahorros
      summary: Tips de ahorro
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tips
    post:
      tags:
        - Ahorros
      summary: Generar tips
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tips generados

  /api/v2/savings/budget-alerts:
    get:
      tags:
        - Ahorros
      summary: Alertas de presupuesto
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Alertas
    post:
      tags:
        - Ahorros
      summary: Crear alerta
      security:
        - BearerAuth: []
      responses:
        '201':
          description: Alerta creada

  /api/v2/savings/health-score:
    get:
      tags:
        - Ahorros
      summary: Puntuaci칩n financiera
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Puntuaci칩n
    post:
      tags:
        - Ahorros
      summary: Calcular puntuaci칩n
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Puntuaci칩n calculada

  /api/v2/savings/weekly-report:
    get:
      tags:
        - Ahorros
      summary: Reporte semanal
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Reporte
    post:
      tags:
        - Ahorros
      summary: Generar reporte
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Reporte generado

  /api/v2/savings/complete:
    get:
      tags:
        - Ahorros
      summary: An치lisis completo de ahorros
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis
    post:
      tags:
        - Ahorros
      summary: An치lisis completo
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis generado

  /api/v2/firebase/users/{usuario_id}/savings/goals:
    get:
      tags:
        - Ahorros Firebase
      summary: Metas (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Metas

  /api/v2/firebase/users/{usuario_id}/savings/tips:
    get:
      tags:
        - Ahorros Firebase
      summary: Tips (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tips

  /api/v2/firebase/users/{usuario_id}/savings/budget-alerts:
    get:
      tags:
        - Ahorros Firebase
      summary: Alertas (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Alertas

  /api/v2/firebase/users/{usuario_id}/savings/health-score:
    get:
      tags:
        - Ahorros Firebase
      summary: Puntuaci칩n (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Puntuaci칩n

  /api/v2/firebase/users/{usuario_id}/savings/weekly-report:
    get:
      tags:
        - Ahorros Firebase
      summary: Reporte (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Reporte

  /api/v2/firebase/users/{usuario_id}/savings/complete:
    get:
      tags:
        - Ahorros Firebase
      summary: An치lisis completo (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/charts/heatmap:
    get:
      tags:
        - Gr치ficos
      summary: Heatmap de gastos
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Heatmap
    post:
      tags:
        - Gr치ficos
      summary: Generar heatmap
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Heatmap generado

  /api/v2/charts/sankey:
    get:
      tags:
        - Gr치ficos
      summary: Diagrama Sankey
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Sankey
    post:
      tags:
        - Gr치ficos
      summary: Generar Sankey
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Sankey generado

  /api/v2/charts/dashboard:
    get:
      tags:
        - Gr치ficos
      summary: Dashboard interactivo
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Dashboard
    post:
      tags:
        - Gr치ficos
      summary: Generar dashboard
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Dashboard generado

  /api/v2/charts/comparison:
    get:
      tags:
        - Gr치ficos
      summary: Comparaci칩n mensual
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n
    post:
      tags:
        - Gr치ficos
      summary: Generar comparaci칩n
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n generada

  /api/v2/charts/export:
    get:
      tags:
        - Gr치ficos
      summary: Exportar gr치ficos
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gr치ficos exportados
    post:
      tags:
        - Gr치ficos
      summary: Exportar como imagen
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Imagen generada

  /api/v2/charts/complete:
    get:
      tags:
        - Gr치ficos
      summary: Todos los gr치ficos
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gr치ficos
    post:
      tags:
        - Gr치ficos
      summary: Generar todos los gr치ficos
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gr치ficos generados

  /api/v2/firebase/users/{usuario_id}/charts/heatmap:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Heatmap (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Heatmap

  /api/v2/firebase/users/{usuario_id}/charts/sankey:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Sankey (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Sankey

  /api/v2/firebase/users/{usuario_id}/charts/dashboard:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Dashboard (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Dashboard

  /api/v2/firebase/users/{usuario_id}/charts/comparison:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Comparaci칩n (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Comparaci칩n

  /api/v2/firebase/users/{usuario_id}/charts/export:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Exportar (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gr치ficos exportados

  /api/v2/firebase/users/{usuario_id}/charts/complete:
    get:
      tags:
        - Gr치ficos Firebase
      summary: Todos los gr치ficos (Firebase)
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Gr치ficos

  /api/v2/me/send-notification:
    post:
      tags:
        - Notificaciones
      summary: Enviar notificaci칩n
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                titulo:
                  type: string
                mensaje:
                  type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Notificaci칩n enviada

  /api/v2/firebase/users/{usuario_id}/asesor-financiero:
    get:
      tags:
        - Asesor Financiero IA
      summary: Asesor Financiero Completo
      description: An치lisis completo con todas las caracter칤sticas de IA
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis completo del asesor

  /api/v2/firebase/users/{usuario_id}/predicciones:
    get:
      tags:
        - Asesor Financiero IA
      summary: Predicciones del usuario
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Predicciones

  /api/v2/firebase/users/{usuario_id}/analisis:
    get:
      tags:
        - Asesor Financiero IA
      summary: An치lisis estad칤stico completo
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: An치lisis

  /api/v2/firebase/users/{usuario_id}/recomendaciones:
    get:
      tags:
        - Asesor Financiero IA
      summary: Recomendaciones personalizadas
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Recomendaciones

  /api/v2/firebase/users/{usuario_id}/graficos:
    get:
      tags:
        - Asesor Financiero IA
      summary: Datos para gr치ficos
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Datos de gr치ficos

  /api/v2/firebase/users/{usuario_id}/score:
    get:
      tags:
        - Asesor Financiero IA
      summary: Puntuaci칩n financiera
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Puntuaci칩n calculada
