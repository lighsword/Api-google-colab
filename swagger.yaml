openapi: 3.0.0
info:
  title: Gestor Financiero IA API
  version: 2.0.0
  description: |
    API avanzada con 20 caracter√≠sticas de Inteligencia Artificial para gesti√≥n financiera personal.
    
    ## üöÄ Caracter√≠sticas Principales
    
    ### üìä PREDICCI√ìN DE GASTOS (5 mejoras)
    1. Predicci√≥n por categor√≠a
    2. Predicci√≥n mensual (30 d√≠as)
    3. Detecci√≥n de anomal√≠as
    4. M√∫ltiples modelos ML (ARIMA, Prophet, LSTM)
    5. An√°lisis de estacionalidad
    
    ### üìà AN√ÅLISIS ESTAD√çSTICO (5 mejoras)
    6. Correlaciones entre categor√≠as
    7. An√°lisis temporal (mes actual vs anterior)
    8. Clustering autom√°tico de gastos
    9. Detecci√≥n de tendencias
    10. Identificaci√≥n de outliers (IQR + Z-Score)
    
    ### üí° RECOMENDACIONES DE AHORRO (5 mejoras)
    11. Metas de ahorro (objetivos espec√≠ficos)
    12. Tips personalizados (basados en patrones)
    13. Alertas de presupuesto (l√≠mites mensuales)
    14. Gamificaci√≥n (puntuaci√≥n financiera)
    15. Reportes autom√°ticos (resumen semanal)
    
    ### üìä GR√ÅFICOS Y VISUALIZACI√ìN (5 mejoras)
    16. Calendario de calor (Heatmap de gastos)
    17. Gr√°fico Sankey (Flujo de dinero)
    18. Dashboard interactivo (Panel con filtros)
    19. Comparativas (Mes vs mes anterior)
    20. Exportar como imagen (PNG/PDF)
    
    ## üîê Autenticaci√≥n
    
    Todos los endpoints (excepto `/auth/token` y `/health`) requieren autenticaci√≥n mediante JWT.
    
    **Paso 1:** Obtener token en `/api/v2/auth/token`
    
    **Paso 2:** Incluir token en headers:
    - `Authorization: Bearer {token}` o
    - `X-API-Key: {token}`

servers:
  - url: https://api-google-colab.onrender.com
    description: Servidor de producci√≥n (Render)
  - url: http://localhost:5000
    description: Servidor de desarrollo local

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

paths:
  # ===== AUTENTICACI√ìN =====
  /api/v2/auth/token:
    post:
      tags:
        - Autenticaci√≥n
      summary: Generar token JWT
      description: |
        Genera un token de autenticaci√≥n JWT v√°lido por 24 horas.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
              properties:
                user_id:
                  type: string
                  example: "abc123xyz789"
      responses:
        '200':
          description: Token generado exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  user_id: "abc123xyz789"

  # ===== NOTIFICACIONES PUSH =====
  /api/Firebase/sendnotificacion:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar notificaci√≥n push (sin autenticaci√≥n)
      description: |
        Env√≠a una notificaci√≥n push a un dispositivo espec√≠fico usando Firebase Cloud Messaging.
        
        **Sin necesidad de autenticaci√≥n JWT**, solo necesitas el token del dispositivo.
        
        **Uso t√≠pico:** Alertas del servidor, notificaciones del sistema
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - strToken
                - strTitle
                - strMessage
              properties:
                strToken:
                  type: string
                  example: "e7sJ2xK9nP3lQ5mR8vT2xZ1cA4dE6fG9hI0jK3lM5n"
                  description: Token FCM del dispositivo
                strTitle:
                  type: string
                  example: "Gasto Detectado"
                  description: T√≠tulo de la notificaci√≥n (m√°x 100 caracteres)
                strMessage:
                  type: string
                  example: "Detectamos un gasto de $100 en Comida"
                  description: Cuerpo del mensaje (m√°x 240 caracteres)
                mapData:
                  type: object
                  description: Datos adicionales personalizados (m√°x 4KB)
                  example:
                    categoria: "Comida"
                    monto: "100"
                    tipo_alerta: "gasto_detectado"
                    id_transaccion: "txn_12345"
      responses:
        '200':
          description: Notificaci√≥n enviada exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Notificaci√≥n enviada exitosamente"
                  message_id: "0:1675849384938204%3a1234567"
                  timestamp: "2026-02-05T18:15:30.123456"
        '400':
          description: Faltan campos requeridos
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Faltan campos requeridos: strToken, strTitle, strMessage"
                  code: "MISSING_FIELDS"
        '503':
          description: Firebase no disponible
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Firebase no disponible"
                  code: "FIREBASE_NOT_AVAILABLE"

  /api/v2/me/send-notification:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar notificaci√≥n a mis dispositivos (RECOMENDADO)
      description: |
        Env√≠a una notificaci√≥n push a TODOS los dispositivos registrados del usuario autenticado.
        
        **Requiere autenticaci√≥n JWT.**
        
        **‚≠ê ESTA ES LA FORMA CORRECTA DE USAR EN SWAGGER:**
        
        1. Click en "Authorize" (bot√≥n verde arriba)
        2. Pega tu JWT en el campo "Authorization"
        3. Este endpoint usa autom√°ticamente tu user_id del JWT
        4. No necesitas pasar usuario_id en la URL
        
        **Ventajas:**
        - ‚úÖ Usa autom√°ticamente tu user_id del JWT
        - ‚úÖ No hay confusi√≥n con par√°metros en la URL
        - ‚úÖ M√°s seguro
        - ‚úÖ M√°s simple de usar
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - titulo
                - cuerpo
              properties:
                titulo:
                  type: string
                  example: "¬°Meta Alcanzada!"
                  description: T√≠tulo de la notificaci√≥n
                cuerpo:
                  type: string
                  example: "Felicidades, ahorraste $1,000 en alimentaci√≥n"
                  description: Cuerpo del mensaje
                datos_extra:
                  type: object
                  description: Datos adicionales opcionales
                  example:
                    tipo: "meta_alcanzada"
                    meta_id: "meta_123"
                    monto: "1000"
      responses:
        '200':
          description: Notificaci√≥n enviada exitosamente (o sin dispositivos registrados)
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
                  mensajes_enviados: 2
                  mensaje: "Notificaci√≥n enviada a 2 dispositivos"
        '400':
          description: |
            - Faltan campos requeridos (titulo, cuerpo)
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Faltan campos requeridos: titulo, cuerpo"
        '401':
          description: Token requerido o inv√°lido
        '503':
          description: Firebase no disponible

  /api/v2/users/{usuario_id}/send-notification:
    post:
      deprecated: true
      tags:
        - üîî Notificaciones
      summary: "[DEPRECATED] Enviar notificaci√≥n a usuario espec√≠fico"
      description: |
        ‚ö†Ô∏è **DEPRECATED** - Usa `/api/v2/me/send-notification` en su lugar.
        
        Este endpoint todav√≠a funciona pero requiere usuario_id en la URL.
        
        Usa `/api/v2/me/send-notification` que es m√°s simple y seguro.
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          description: ID real del usuario (NO el JWT)
          example: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - titulo
                - cuerpo
              properties:
                titulo:
                  type: string
                  example: "¬°Meta Alcanzada!"
                  description: T√≠tulo de la notificaci√≥n
                cuerpo:
                  type: string
                  example: "Felicidades, ahorraste $1,000 en alimentaci√≥n"
                  description: Cuerpo del mensaje
                datos_extra:
                  type: object
                  description: Datos adicionales opcionales
                  example:
                    tipo: "meta_alcanzada"
                    meta_id: "meta_123"
                    monto: "1000"
      responses:
        '200':
          description: Notificaci√≥n enviada exitosamente (o sin dispositivos registrados)
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
                  mensajes_enviados: 2
                  mensaje: "Notificaci√≥n enviada a 2 dispositivos"
        '400':
          description: |
            - Faltan campos requeridos (titulo, cuerpo)
            - Usuario inv√°lido
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Faltan campos requeridos: titulo, cuerpo"
        '401':
          description: Token requerido o inv√°lido
        '403':
          description: No tienes permiso para enviar notificaciones a este usuario
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "No tienes permiso para enviar notificaciones a este usuario"
        '503':
          description: Firebase no disponible

  # ===== PREDICCI√ìN PERSONALIZADA =====
  /api/v2/users/{usuario_id}/predict-category:
    get:
      tags:
        - üìä Predicci√≥n Personalizada
      summary: Predicci√≥n de categor√≠a (filtrada)
      description: |
        Predicci√≥n de gastos por categor√≠a espec√≠fica.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-20",
          "monto": 85.50,
          "categoria": "Comida"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user123"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Comida"
      responses:
        '200':
          description: Predicci√≥n exitosa
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user123"
                  categoria: "Comida"
                  data:
                    prediccion_proximos_30_dias: 2550.75
                    gasto_promedio_diario: 85.03
                    tendencia: "estable"
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv√°lido
        '500':
          description: Error en predicci√≥n

  /api/v2/users/{usuario_id}/predict-monthly:
    get:
      tags:
        - üìä Predicci√≥n Personalizada
      summary: Predicci√≥n mensual (filtrada)
      description: |
        Predicci√≥n de gastos mensuales (30 d√≠as).
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-18",
          "monto": 45.00,
          "categoria": "Transporte"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user456"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Transporte"
      responses:
        '200':
          description: Predicci√≥n mensual exitosa
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user456"
                  categoria: "Transporte"
                  data:
                    prediccion_mes: 1350.00
                    semanas:
                      - semana: 1
                        estimado: 337.50
                      - semana: 2
                        estimado: 337.50
                      - semana: 3
                        estimado: 337.50
                      - semana: 4
                        estimado: 337.50
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv√°lido

  /api/v2/users/{usuario_id}/detect-anomalies:
    get:
      tags:
        - üìä Predicci√≥n Personalizada
      summary: Detecci√≥n de anomal√≠as (filtrada)
      description: |
        Detecta gastos an√≥malos o inusuales.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-25",
          "monto": 250.00,
          "categoria": "Entretenimiento"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user789"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Entretenimiento"
      responses:
        '200':
          description: An√°lisis de anomal√≠as exitoso
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user789"
                  categoria: "Entretenimiento"
                  data:
                    anomalias_detectadas: 2
                    gastos_atipicos:
                      - fecha: "2024-12-25"
                        monto: 500.00
                        razon: "Valor muy alto (3x promedio)"
                      - fecha: "2024-12-10"
                        monto: 750.00
                        razon: "Valor at√≠pico detectado"
                    umbral_deteccion: 150.00
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv√°lido

  /api/v2/users/{usuario_id}/analysis-complete:
    get:
      tags:
        - üìä Predicci√≥n Personalizada
      summary: An√°lisis completo personalizado
      description: |
        An√°lisis completo: predicci√≥n, anomal√≠as, comparaci√≥n de modelos y estacionalidad.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-22",
          "monto": 120.50,
          "categoria": "Compras"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user999"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Compras"
      responses:
        '200':
          description: An√°lisis completo exitoso
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user999"
                  categoria: "Compras"
                  data:
                    prediccion_categoria:
                      prediccion_proximos_30_dias: 3600.00
                    prediccion_mensual:
                      estimado_mes: 3600.00
                      por_semana: 900.00
                    anomalias:
                      detectadas: 1
                      gastos_atipicos:
                        - monto: 1500.00
                          razon: "Compra grande detectada"
                    comparacion_modelos:
                      mejor_modelo: "Prophet"
                      precision: 0.87
                    estacionalidad:
                      patron: "Semanal"
                      picos_dias: ["viernes", "s√°bado"]
                    timestamp: "2026-02-05T15:30:45.123456"
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv√°lido
        '500':
          description: Error en el an√°lisis

  # ===== FIREBASE INTEGRATION =====
  /api/v2/firebase/users/{usuario_id}/gastos:
    get:
      tags:
        - üî• Firebase Integration
      summary: Obtener gastos del usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gastos obtenidos exitosamente
    
    post:
      tags:
        - üî• Firebase Integration
      summary: Crear nuevo gasto
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                monto:
                  type: number
                categoria:
                  type: string
                fecha:
                  type: string
              example:
                fecha: "2024-12-20"
                monto: 85.50
                categoria: "Comida"
      responses:
        '201':
          description: Gasto creado exitosamente

  /api/v2/firebase/debug:
    get:
      tags:
        - üîß Debug & Utilidades
      summary: Debug de Firebase
      security: []
      responses:
        '200':
          description: Informaci√≥n de debug

  # ===== AN√ÅLISIS PREDICTIVO (GEN√âRICOS) =====
  /api/v2/predict-category:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: Predicci√≥n por categor√≠a (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Predicci√≥n exitosa

  /api/v2/predict-monthly:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: Predicci√≥n mensual (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Predicci√≥n exitosa

  /api/v2/detect-anomalies:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: Detecci√≥n de anomal√≠as (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis completado

  /api/v2/compare-models:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: Comparaci√≥n de modelos (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci√≥n completada

  /api/v2/seasonality:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: An√°lisis de estacionalidad (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis completado

  /api/v2/analysis-complete:
    get:
      tags:
        - üìä Predicci√≥n de Gastos
      summary: An√°lisis completo (gen√©rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis completado

  # ===== AN√ÅLISIS ESTAD√çSTICO =====
  /api/v2/stat/correlations:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: Correlaciones entre categor√≠as
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis de correlaciones

  /api/v2/stat/temporal-comparison:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: Comparaci√≥n temporal
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci√≥n temporal

  /api/v2/stat/clustering:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: Clustering de gastos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Clustering completado

  /api/v2/stat/trends:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: Detecci√≥n de tendencias
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tendencias detectadas

  /api/v2/stat/outliers:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: Detecci√≥n de outliers
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Outliers detectados

  /api/v2/stat/complete:
    get:
      tags:
        - üìà An√°lisis Estad√≠stico
      summary: An√°lisis estad√≠stico completo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis completado

  # ===== RECOMENDACIONES DE AHORRO =====
  /api/v2/savings/goals:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Metas de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Metas obtenidas
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Crear meta de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '201':
          description: Meta creada

  /api/v2/savings/tips:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Tips personalizados
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tips generados
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Generar tips
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tips generados

  /api/v2/savings/budget-alerts:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Alertas de presupuesto
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Alertas obtenidas
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Crear alerta
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '201':
          description: Alerta creada

  /api/v2/savings/health-score:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Puntuaci√≥n financiera
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Puntuaci√≥n calculada
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Calcular puntuaci√≥n
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Puntuaci√≥n calculada

  /api/v2/savings/weekly-report:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Reporte semanal
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Reporte generado
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Generar reporte
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Reporte generado

  /api/v2/savings/complete:
    get:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: An√°lisis completo de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis completado
    post:
      tags:
        - üí° Recomendaciones de Ahorro
      summary: Generar an√°lisis completo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An√°lisis generado

  # ===== GR√ÅFICOS Y VISUALIZACI√ìN =====
  /api/v2/charts/heatmap:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Calendario de calor
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Heatmap generado
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Generar heatmap
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Heatmap generado

  /api/v2/charts/sankey:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Diagrama Sankey
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Diagrama generado
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Generar Sankey
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Diagrama generado

  /api/v2/charts/dashboard:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Dashboard interactivo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Dashboard generado
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Generar dashboard
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Dashboard generado

  /api/v2/charts/comparison:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Comparaci√≥n mensual
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci√≥n generada
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Generar comparaci√≥n
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci√≥n generada

  /api/v2/charts/export:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Exportar gr√°ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr√°ficos exportados
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Exportar gr√°ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr√°ficos exportados

  /api/v2/charts/complete:
    get:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Todos los gr√°ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr√°ficos generados
    post:
      tags:
        - üìä Gr√°ficos y Visualizaci√≥n
      summary: Generar todos los gr√°ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr√°ficos generados

  # ===== FIREBASE INTEGRATION COMPLETA =====
  /api/v2/firebase/usuarios:
    get:
      tags:
        - üî• Firebase Integration
      summary: Obtener todos los usuarios
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Usuarios obtenidos

  /api/v2/firebase/usuarios/{usuario_id}:
    get:
      tags:
        - üî• Firebase Integration
      summary: Obtener usuario espec√≠fico
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Usuario obtenido

  /api/v2/firebase/users/{usuario_id}/gastos-procesados:
    get:
      tags:
        - üî• Firebase Integration
      summary: Obtener gastos procesados
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gastos procesados

  /api/v2/firebase/users/{usuario_id}/gastos-ids:
    get:
      tags:
        - üî• Firebase Integration
      summary: Obtener IDs de gastos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: IDs obtenidos

  # ===== ASESOR FINANCIERO IA =====
  /api/v2/firebase/users/{usuario_id}/asesor-financiero:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: An√°lisis completo con IA
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An√°lisis generado

  /api/v2/firebase/users/{usuario_id}/predicciones:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: Predicciones para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Predicciones generadas

  /api/v2/firebase/users/{usuario_id}/analisis:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: An√°lisis estad√≠stico para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An√°lisis completado

  /api/v2/firebase/users/{usuario_id}/recomendaciones:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: Recomendaciones para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Recomendaciones generadas

  /api/v2/firebase/users/{usuario_id}/graficos:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: Gr√°ficos para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr√°ficos generados

  /api/v2/firebase/users/{usuario_id}/score:
    get:
      tags:
        - ü§ñ Asesor Financiero IA
      summary: Puntuaci√≥n financiera del usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Puntuaci√≥n calculada

  # ===== NOTIFICACIONES =====
  /api/v2/notifications/register-device:
    post:
      tags:
        - üîî Notificaciones
      summary: Registrar dispositivo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '201':
          description: Dispositivo registrado

  /api/v2/notifications/unregister-device:
    post:
      tags:
        - üîî Notificaciones
      summary: Desregistrar dispositivo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Dispositivo desregistrado

  /api/v2/notifications/send:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar notificaci√≥n
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Notificaci√≥n enviada

  /api/v2/notifications/send-bulk:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar notificaciones masivas
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Notificaciones enviadas

  /api/v2/notifications/history/{usuario_id}:
    get:
      tags:
        - üîî Notificaciones
      summary: Historial de notificaciones
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Historial obtenido

  /api/v2/notifications/send-alert/{usuario_id}:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar alerta a usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Alerta enviada

  /api/v2/notifications/send-tips/{usuario_id}:
    post:
      tags:
        - üîî Notificaciones
      summary: Enviar tips a usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tips enviados

  # ===== FIREBASE USER-SPECIFIC ENDPOINTS =====
  /api/v2/firebase/users/{usuario_id}/compare-models:
    get:
      tags:
        - üî• Firebase Integration
      summary: Comparaci√≥n de modelos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci√≥n completada

  /api/v2/firebase/users/{usuario_id}/seasonality:
    get:
      tags:
        - üî• Firebase Integration
      summary: An√°lisis de estacionalidad (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An√°lisis completado

  # ===== FIREBASE STATS =====
  /api/v2/firebase/users/{usuario_id}/stat/correlations:
    get:
      tags:
        - üî• Firebase Stats
      summary: Correlaciones (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Correlaciones calculadas

  /api/v2/firebase/users/{usuario_id}/stat/temporal-comparison:
    get:
      tags:
        - üî• Firebase Stats
      summary: Comparaci√≥n temporal (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci√≥n completada

  /api/v2/firebase/users/{usuario_id}/stat/clustering:
    get:
      tags:
        - üî• Firebase Stats
      summary: Clustering (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Clustering completado

  /api/v2/firebase/users/{usuario_id}/stat/trends:
    get:
      tags:
        - üî• Firebase Stats
      summary: Tendencias (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tendencias calculadas

  /api/v2/firebase/users/{usuario_id}/stat/outliers:
    get:
      tags:
        - üî• Firebase Stats
      summary: Outliers (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Outliers detectados

  /api/v2/firebase/users/{usuario_id}/stat/complete:
    get:
      tags:
        - üî• Firebase Stats
      summary: An√°lisis estad√≠stico completo (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An√°lisis completado

  # ===== FIREBASE SAVINGS =====
  /api/v2/firebase/users/{usuario_id}/savings/goals:
    get:
      tags:
        - üî• Firebase Savings
      summary: Metas de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Metas obtenidas

  /api/v2/firebase/users/{usuario_id}/savings/tips:
    get:
      tags:
        - üî• Firebase Savings
      summary: Tips de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tips generados

  /api/v2/firebase/users/{usuario_id}/savings/budget-alerts:
    get:
      tags:
        - üî• Firebase Savings
      summary: Alertas de presupuesto (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Alertas generadas

  /api/v2/firebase/users/{usuario_id}/savings/health-score:
    get:
      tags:
        - üî• Firebase Savings
      summary: Puntuaci√≥n de salud financiera (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Puntuaci√≥n calculada

  /api/v2/firebase/users/{usuario_id}/savings/weekly-report:
    get:
      tags:
        - üî• Firebase Savings
      summary: Reporte semanal (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Reporte generado

  /api/v2/firebase/users/{usuario_id}/savings/complete:
    get:
      tags:
        - üî• Firebase Savings
      summary: An√°lisis completo de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An√°lisis completado

  # ===== FIREBASE CHARTS =====
  /api/v2/firebase/users/{usuario_id}/charts/heatmap:
    get:
      tags:
        - üî• Firebase Charts
      summary: Heatmap de gastos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Heatmap generado

  /api/v2/firebase/users/{usuario_id}/charts/sankey:
    get:
      tags:
        - üî• Firebase Charts
      summary: Diagrama Sankey (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Diagrama generado

  /api/v2/firebase/users/{usuario_id}/charts/dashboard:
    get:
      tags:
        - üî• Firebase Charts
      summary: Dashboard interactivo (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Dashboard generado

  /api/v2/firebase/users/{usuario_id}/charts/comparison:
    get:
      tags:
        - üî• Firebase Charts
      summary: Comparaci√≥n mensual (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci√≥n generada

  /api/v2/firebase/users/{usuario_id}/charts/export:
    get:
      tags:
        - üî• Firebase Charts
      summary: Exportar gr√°ficos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr√°ficos exportados

  /api/v2/firebase/users/{usuario_id}/charts/complete:
    get:
      tags:
        - üî• Firebase Charts
      summary: Todos los gr√°ficos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr√°ficos generados