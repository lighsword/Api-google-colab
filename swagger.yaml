openapi: 3.0.0
info:
  title: Gestor Financiero IA API
  version: 2.0.0
  description: |
    API avanzada con 20 caracter칤sticas de Inteligencia Artificial para gesti칩n financiera personal.
    
    ## 游 Caracter칤sticas Principales
    
    ### 游늵 PREDICCI칍N DE GASTOS (5 mejoras)
    1. Predicci칩n por categor칤a
    2. Predicci칩n mensual (30 d칤as)
    3. Detecci칩n de anomal칤as
    4. M칰ltiples modelos ML (ARIMA, Prophet, LSTM)
    5. An치lisis de estacionalidad
    
    ### 游늳 AN츼LISIS ESTAD칈STICO (5 mejoras)
    6. Correlaciones entre categor칤as
    7. An치lisis temporal (mes actual vs anterior)
    8. Clustering autom치tico de gastos
    9. Detecci칩n de tendencias
    10. Identificaci칩n de outliers (IQR + Z-Score)
    
    ### 游눠 RECOMENDACIONES DE AHORRO (5 mejoras)
    11. Metas de ahorro (objetivos espec칤ficos)
    12. Tips personalizados (basados en patrones)
    13. Alertas de presupuesto (l칤mites mensuales)
    14. Gamificaci칩n (puntuaci칩n financiera)
    15. Reportes autom치ticos (resumen semanal)
    
    ### 游늵 GR츼FICOS Y VISUALIZACI칍N (5 mejoras)
    16. Calendario de calor (Heatmap de gastos)
    17. Gr치fico Sankey (Flujo de dinero)
    18. Dashboard interactivo (Panel con filtros)
    19. Comparativas (Mes vs mes anterior)
    20. Exportar como imagen (PNG/PDF)
    
    ## 游댏 Autenticaci칩n
    
    Todos los endpoints (excepto `/auth/token` y `/health`) requieren autenticaci칩n mediante JWT.
    
    **Paso 1:** Obtener token en `/api/v2/auth/token`
    
    **Paso 2:** Incluir token en headers:
    - `Authorization: Bearer {token}` o
    - `X-API-Key: {token}`

servers:
  - url: https://api-google-colab.onrender.com
    description: Servidor de producci칩n (Render)
  - url: http://localhost:5000
    description: Servidor de desarrollo local

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

paths:
  # ===== AUTENTICACI칍N =====
  /api/v2/auth/token:
    post:
      tags:
        - Autenticaci칩n
      summary: Generar token JWT
      description: |
        Genera un token de autenticaci칩n JWT v치lido por 24 horas.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
              properties:
                user_id:
                  type: string
                  example: "abc123xyz789"
      responses:
        '200':
          description: Token generado exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  user_id: "abc123xyz789"

  # ===== NOTIFICACIONES PUSH =====
  /api/Firebase/sendnotificacion:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar notificaci칩n push (sin autenticaci칩n)
      description: |
        Env칤a una notificaci칩n push a un dispositivo espec칤fico usando Firebase Cloud Messaging.
        
        **Sin necesidad de autenticaci칩n JWT**, solo necesitas el token del dispositivo.
        
        **Uso t칤pico:** Alertas del servidor, notificaciones del sistema
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - strToken
                - strTitle
                - strMessage
              properties:
                strToken:
                  type: string
                  example: "e7sJ2xK9nP3lQ5mR8vT2xZ1cA4dE6fG9hI0jK3lM5n"
                  description: Token FCM del dispositivo
                strTitle:
                  type: string
                  example: "Gasto Detectado"
                  description: T칤tulo de la notificaci칩n (m치x 100 caracteres)
                strMessage:
                  type: string
                  example: "Detectamos un gasto de $100 en Comida"
                  description: Cuerpo del mensaje (m치x 240 caracteres)
                mapData:
                  type: object
                  description: Datos adicionales personalizados (m치x 4KB)
                  example:
                    categoria: "Comida"
                    monto: "100"
                    tipo_alerta: "gasto_detectado"
                    id_transaccion: "txn_12345"
      responses:
        '200':
          description: Notificaci칩n enviada exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Notificaci칩n enviada exitosamente"
                  message_id: "0:1675849384938204%3a1234567"
                  timestamp: "2026-02-05T18:15:30.123456"
        '400':
          description: Faltan campos requeridos
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Faltan campos requeridos: strToken, strTitle, strMessage"
                  code: "MISSING_FIELDS"
        '503':
          description: Firebase no disponible
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Firebase no disponible"
                  code: "FIREBASE_NOT_AVAILABLE"

  /api/v2/me/send-notification:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar notificaci칩n personalizada a mis dispositivos
      description: |
        Env칤a una notificaci칩n push personalizada a TODOS los dispositivos registrados del usuario autenticado.
        
        **Requiere autenticaci칩n JWT.**
        
        **La app puede configurar:**
        - T칤tulo y cuerpo del mensaje
        - Descripci칩n detallada
        - Tipo de alerta (para manejar diferentes flujos en la app)
        - Datos adicionales personalizados
        
        **Tipos de alertas disponibles:**
        - `gasto_anomalico`: Gasto inusual detectado
        - `meta_alcanzada`: Usuario alcanz칩 una meta
        - `presupuesto_excedido`: Se excedi칩 el presupuesto
        - `presupuesto_proximo`: Presupuesto casi agotado
        - `consejo`: Consejo de ahorro personalizado
        - `recordatorio`: Recordatorio importante
        - `celebracion`: Celebraci칩n de logro
        - `alerta_general`: Alerta general del sistema
        
        **C칩mo usar en Swagger:**
        1. Click en "Authorize" (bot칩n verde arriba)
        2. Pega tu JWT en el campo
        3. Este endpoint usa autom치ticamente tu user_id del JWT
        4. Env칤a los datos del mensaje
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - titulo
                - cuerpo
              properties:
                titulo:
                  type: string
                  example: "丘멆잺 Gasto An칩malo"
                  description: T칤tulo de la notificaci칩n (m치x 100 caracteres)
                cuerpo:
                  type: string
                  example: "Detectamos un gasto de $500 en Transporte"
                  description: Cuerpo del mensaje (m치x 240 caracteres)
                descripcion:
                  type: string
                  example: "Este gasto es 3x mayor que tu promedio. 쮼s correcto?"
                  description: Descripci칩n detallada (opcional)
                tipo_alerta:
                  type: string
                  example: "gasto_anomalico"
                  description: |
                    Tipo de alerta (opcional, default: "alerta_general")
                    
                    Valores v치lidos:
                    - gasto_anomalico
                    - meta_alcanzada
                    - presupuesto_excedido
                    - presupuesto_proximo
                    - consejo
                    - recordatorio
                    - celebracion
                    - alerta_general
                datos_extra:
                  type: object
                  description: Datos adicionales personalizados (se env칤an a la app)
                  example:
                    monto: 500
                    categoria: "Transporte"
                    promedio: 165
      responses:
        '200':
          description: Notificaci칩n enviada exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
                  tipo_alerta: "gasto_anomalico"
                  mensajes_enviados: 2
                  mensaje: "Notificaci칩n enviada a 2 dispositivos"
                  exitosos: 2
                  fallidos: 0
        '400':
          description: |
            - Faltan campos requeridos (titulo, cuerpo)
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "error"
                  mensaje: "Faltan campos requeridos: titulo, cuerpo"
        '401':
          description: Token requerido o inv치lido
        '503':
          description: Firebase no disponible

  # ===== PREDICCI칍N PERSONALIZADA =====
  /api/v2/users/{usuario_id}/predict-category:
    get:
      tags:
        - 游늵 Predicci칩n Personalizada
      summary: Predicci칩n de categor칤a (filtrada)
      description: |
        Predicci칩n de gastos por categor칤a espec칤fica.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-20",
          "monto": 85.50,
          "categoria": "Comida"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user123"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Comida"
      responses:
        '200':
          description: Predicci칩n exitosa
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user123"
                  categoria: "Comida"
                  data:
                    prediccion_proximos_30_dias: 2550.75
                    gasto_promedio_diario: 85.03
                    tendencia: "estable"
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv치lido
        '500':
          description: Error en predicci칩n

  /api/v2/users/{usuario_id}/predict-monthly:
    get:
      tags:
        - 游늵 Predicci칩n Personalizada
      summary: Predicci칩n mensual (filtrada)
      description: |
        Predicci칩n de gastos mensuales (30 d칤as).
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-18",
          "monto": 45.00,
          "categoria": "Transporte"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user456"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Transporte"
      responses:
        '200':
          description: Predicci칩n mensual exitosa
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user456"
                  categoria: "Transporte"
                  data:
                    prediccion_mes: 1350.00
                    semanas:
                      - semana: 1
                        estimado: 337.50
                      - semana: 2
                        estimado: 337.50
                      - semana: 3
                        estimado: 337.50
                      - semana: 4
                        estimado: 337.50
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv치lido

  /api/v2/users/{usuario_id}/detect-anomalies:
    get:
      tags:
        - 游늵 Predicci칩n Personalizada
      summary: Detecci칩n de anomal칤as (filtrada)
      description: |
        Detecta gastos an칩malos o inusuales.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-25",
          "monto": 250.00,
          "categoria": "Entretenimiento"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user789"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Entretenimiento"
      responses:
        '200':
          description: An치lisis de anomal칤as exitoso
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user789"
                  categoria: "Entretenimiento"
                  data:
                    anomalias_detectadas: 2
                    gastos_atipicos:
                      - fecha: "2024-12-25"
                        monto: 500.00
                        razon: "Valor muy alto (3x promedio)"
                      - fecha: "2024-12-10"
                        monto: 750.00
                        razon: "Valor at칤pico detectado"
                    umbral_deteccion: 150.00
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv치lido

  /api/v2/users/{usuario_id}/analysis-complete:
    get:
      tags:
        - 游늵 Predicci칩n Personalizada
      summary: An치lisis completo personalizado
      description: |
        An치lisis completo: predicci칩n, anomal칤as, comparaci칩n de modelos y estacionalidad.
        
        **Datos en Firebase:**
        ```json
        {
          "fecha": "2024-12-22",
          "monto": 120.50,
          "categoria": "Compras"
        }
        ```
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "user999"
        - name: category
          in: query
          required: false
          schema:
            type: string
          example: "Compras"
      responses:
        '200':
          description: An치lisis completo exitoso
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  usuario_id: "user999"
                  categoria: "Compras"
                  data:
                    prediccion_categoria:
                      prediccion_proximos_30_dias: 3600.00
                    prediccion_mensual:
                      estimado_mes: 3600.00
                      por_semana: 900.00
                    anomalias:
                      detectadas: 1
                      gastos_atipicos:
                        - monto: 1500.00
                          razon: "Compra grande detectada"
                    comparacion_modelos:
                      mejor_modelo: "Prophet"
                      precision: 0.87
                    estacionalidad:
                      patron: "Semanal"
                      picos_dias: ["viernes", "s치bado"]
                    timestamp: "2026-02-05T15:30:45.123456"
        '400':
          description: Sin datos en Firebase
        '401':
          description: Token requerido o inv치lido
        '500':
          description: Error en el an치lisis

  # ===== FIREBASE INTEGRATION =====
  /api/v2/firebase/users/{usuario_id}/gastos:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Obtener gastos del usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gastos obtenidos exitosamente
    
    post:
      tags:
        - 游댠 Firebase Integration
      summary: Crear nuevo gasto
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                monto:
                  type: number
                categoria:
                  type: string
                fecha:
                  type: string
              example:
                fecha: "2024-12-20"
                monto: 85.50
                categoria: "Comida"
      responses:
        '201':
          description: Gasto creado exitosamente

  /api/v2/firebase/debug:
    get:
      tags:
        - 游댢 Debug & Utilidades
      summary: Debug de Firebase
      security: []
      responses:
        '200':
          description: Informaci칩n de debug

  # ===== AN츼LISIS PREDICTIVO (GEN칄RICOS) =====
  /api/v2/predict-category:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: Predicci칩n por categor칤a (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Predicci칩n exitosa

  /api/v2/predict-monthly:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: Predicci칩n mensual (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Predicci칩n exitosa

  /api/v2/detect-anomalies:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: Detecci칩n de anomal칤as (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis completado

  /api/v2/compare-models:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: Comparaci칩n de modelos (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci칩n completada

  /api/v2/seasonality:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: An치lisis de estacionalidad (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis completado

  /api/v2/analysis-complete:
    get:
      tags:
        - 游늵 Predicci칩n de Gastos
      summary: An치lisis completo (gen칠rica)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis completado

  # ===== AN츼LISIS ESTAD칈STICO =====
  /api/v2/stat/correlations:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: Correlaciones entre categor칤as
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis de correlaciones

  /api/v2/stat/temporal-comparison:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: Comparaci칩n temporal
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci칩n temporal

  /api/v2/stat/clustering:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: Clustering de gastos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Clustering completado

  /api/v2/stat/trends:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: Detecci칩n de tendencias
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tendencias detectadas

  /api/v2/stat/outliers:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: Detecci칩n de outliers
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Outliers detectados

  /api/v2/stat/complete:
    get:
      tags:
        - 游늳 An치lisis Estad칤stico
      summary: An치lisis estad칤stico completo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis completado

  # ===== RECOMENDACIONES DE AHORRO =====
  /api/v2/savings/goals:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Metas de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Metas obtenidas
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Crear meta de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '201':
          description: Meta creada

  /api/v2/savings/tips:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Tips personalizados
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tips generados
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Generar tips
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Tips generados

  /api/v2/savings/budget-alerts:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Alertas de presupuesto
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Alertas obtenidas
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Crear alerta
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '201':
          description: Alerta creada

  /api/v2/savings/health-score:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Puntuaci칩n financiera
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Puntuaci칩n calculada
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Calcular puntuaci칩n
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Puntuaci칩n calculada

  /api/v2/savings/weekly-report:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Reporte semanal
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Reporte generado
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Generar reporte
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Reporte generado

  /api/v2/savings/complete:
    get:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: An치lisis completo de ahorro
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis completado
    post:
      tags:
        - 游눠 Recomendaciones de Ahorro
      summary: Generar an치lisis completo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: An치lisis generado

  # ===== GR츼FICOS Y VISUALIZACI칍N =====
  /api/v2/charts/heatmap:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Calendario de calor
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Heatmap generado
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Generar heatmap
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Heatmap generado

  /api/v2/charts/sankey:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Diagrama Sankey
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Diagrama generado
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Generar Sankey
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Diagrama generado

  /api/v2/charts/dashboard:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Dashboard interactivo
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Dashboard generado
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Generar dashboard
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Dashboard generado

  /api/v2/charts/comparison:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Comparaci칩n mensual
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci칩n generada
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Generar comparaci칩n
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Comparaci칩n generada

  /api/v2/charts/export:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Exportar gr치ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr치ficos exportados
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Exportar gr치ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr치ficos exportados

  /api/v2/charts/complete:
    get:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Todos los gr치ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr치ficos generados
    post:
      tags:
        - 游늵 Gr치ficos y Visualizaci칩n
      summary: Generar todos los gr치ficos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Gr치ficos generados

  # ===== FIREBASE INTEGRATION COMPLETA =====
  /api/v2/firebase/usuarios:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Obtener todos los usuarios
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      responses:
        '200':
          description: Usuarios obtenidos

  /api/v2/firebase/usuarios/{usuario_id}:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Obtener usuario espec칤fico
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Usuario obtenido

  /api/v2/firebase/users/{usuario_id}/gastos-procesados:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Obtener gastos procesados
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gastos procesados

  /api/v2/firebase/users/{usuario_id}/gastos-ids:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Obtener IDs de gastos
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: IDs obtenidos

  # ===== ASESOR FINANCIERO IA =====
  /api/v2/firebase/users/{usuario_id}/asesor-financiero:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: An치lisis completo con IA
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An치lisis generado

  /api/v2/firebase/users/{usuario_id}/predicciones:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: Predicciones para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Predicciones generadas

  /api/v2/firebase/users/{usuario_id}/analisis:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: An치lisis estad칤stico para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An치lisis completado

  /api/v2/firebase/users/{usuario_id}/recomendaciones:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: Recomendaciones para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Recomendaciones generadas

  /api/v2/firebase/users/{usuario_id}/graficos:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: Gr치ficos para usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr치ficos generados

  /api/v2/firebase/users/{usuario_id}/score:
    get:
      tags:
        - 游뱄 Asesor Financiero IA
      summary: Puntuaci칩n financiera del usuario
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Puntuaci칩n calculada

  # ===== NOTIFICACIONES =====
  /api/v2/notifications/register-device:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Registrar dispositivo
      description: Registra un token de dispositivo para recibir notificaciones push
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_token
              properties:
                device_token:
                  type: string
                  example: "exjxrMLN4DM:APA91bFqx_zK8Vjl4..."
                  description: Token FCM del dispositivo
                dispositivo_info:
                  type: object
                  description: Informaci칩n adicional del dispositivo (opcional)
                  example:
                    platform: "Android"
                    app_version: "1.0.0"
      responses:
        '200':
          description: Dispositivo registrado exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Dispositivo registrado"
                  usuario_id: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
                  device_token: "exjxrMLN4DM:APA91bFqx..."
        '400':
          description: Error en validaci칩n
        '401':
          description: Token requerido o inv치lido

  /api/v2/notifications/unregister-device:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Desregistrar dispositivo
      description: Elimina un token de dispositivo para dejar de recibir notificaciones
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_token
              properties:
                device_token:
                  type: string
                  example: "exjxrMLN4DM:APA91bFqx_zK8Vjl4..."
                  description: Token FCM del dispositivo a desregistrar
      responses:
        '200':
          description: Dispositivo desregistrado exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Dispositivo desregistrado"
                  usuario_id: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
        '400':
          description: Error en validaci칩n
        '401':
          description: Token requerido o inv치lido

  /api/v2/notifications/send:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar notificaci칩n
      description: Env칤a una notificaci칩n push a un usuario espec칤fico
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - titulo
                - cuerpo
              properties:
                usuario_id:
                  type: string
                  example: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
                  description: ID del usuario (si no se proporciona usa el del JWT)
                titulo:
                  type: string
                  example: "춰Gasto detectado!"
                  description: T칤tulo de la notificaci칩n
                cuerpo:
                  type: string
                  example: "Registramos un gasto de $50 en Comida"
                  description: Cuerpo del mensaje
                datos:
                  type: object
                  description: Datos adicionales (opcional)
                  example:
                    monto: 50
                    categoria: "Comida"
                device_token:
                  type: string
                  description: Token espec칤fico para enviar a un dispositivo (opcional)
      responses:
        '200':
          description: Notificaci칩n enviada exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Notificaci칩n enviada"
        '400':
          description: Error en validaci칩n
        '401':
          description: Token requerido o inv치lido

  /api/v2/notifications/send-bulk:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar notificaciones masivas
      description: Env칤a la misma notificaci칩n a m칰ltiples usuarios
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - usuarios_ids
                - titulo
                - cuerpo
              properties:
                usuarios_ids:
                  type: array
                  items:
                    type: string
                  example: ["user1", "user2", "user3"]
                  description: Lista de IDs de usuarios
                titulo:
                  type: string
                  example: "Mantenimiento de API"
                  description: T칤tulo de la notificaci칩n
                cuerpo:
                  type: string
                  example: "El servidor estar치 en mantenimiento ma침ana"
                  description: Cuerpo del mensaje
                datos:
                  type: object
                  description: Datos adicionales (opcional)
      responses:
        '200':
          description: Notificaciones enviadas exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  resultado:
                    exitosos: 3
                    fallidos: 0
        '400':
          description: Error en validaci칩n
        '401':
          description: Token requerido o inv치lido

  /api/v2/notifications/history/{usuario_id}:
    get:
      tags:
        - 游댒 Notificaciones
      summary: Historial de notificaciones
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Historial obtenido

  /api/v2/notifications/send-alert/{usuario_id}:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar alerta a usuario
      description: Env칤a una alerta de presupuesto/gasto basada en el presupuesto mensual
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
          description: ID del usuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - presupuesto_mensual
              properties:
                presupuesto_mensual:
                  type: number
                  example: 1500.00
                  description: Presupuesto mensual del usuario en USD
      responses:
        '200':
          description: Alerta enviada exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  alerta:
                    titulo: "丘멆잺 Presupuesto casi agotado"
                    cuerpo: "Has utilizado el 87.5% de tu presupuesto mensual"
                    tipo: "ADVERTENCIA"
        '400':
          description: Error en validaci칩n
        '401':
          description: Token requerido o inv치lido

  /api/v2/notifications/send-tips/{usuario_id}:
    post:
      tags:
        - 游댒 Notificaciones
      summary: Enviar tips a usuario
      description: Env칤a recomendaciones personalizadas de ahorro como notificaciones
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
          example: "BCc7NaZ4KQTqFY3dUxgStWH62dh2"
          description: ID del usuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                categoria:
                  type: string
                  example: "Comida"
                  description: Categor칤a espec칤fica para el consejo (opcional)
                tiempo_dias:
                  type: integer
                  example: 30
                  description: D칤as a analizar (default 30)
      responses:
        '200':
          description: Tips enviados exitosamente
          content:
            application/json:
              schema:
                type: object
                example:
                  status: "success"
                  mensaje: "Tips enviados"
                  tips: ["Reduce gastos en Comida", "Compra en supermercados m치s econ칩micos"]
        '400':
          description: Error - sin datos de gastos
        '401':
          description: Token requerido o inv치lido

  # ===== FIREBASE USER-SPECIFIC ENDPOINTS =====
  /api/v2/firebase/users/{usuario_id}/compare-models:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: Comparaci칩n de modelos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci칩n completada

  /api/v2/firebase/users/{usuario_id}/seasonality:
    get:
      tags:
        - 游댠 Firebase Integration
      summary: An치lisis de estacionalidad (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An치lisis completado

  # ===== FIREBASE STATS =====
  /api/v2/firebase/users/{usuario_id}/stat/correlations:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: Correlaciones (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Correlaciones calculadas

  /api/v2/firebase/users/{usuario_id}/stat/temporal-comparison:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: Comparaci칩n temporal (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci칩n completada

  /api/v2/firebase/users/{usuario_id}/stat/clustering:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: Clustering (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Clustering completado

  /api/v2/firebase/users/{usuario_id}/stat/trends:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: Tendencias (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tendencias calculadas

  /api/v2/firebase/users/{usuario_id}/stat/outliers:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: Outliers (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Outliers detectados

  /api/v2/firebase/users/{usuario_id}/stat/complete:
    get:
      tags:
        - 游댠 Firebase Stats
      summary: An치lisis estad칤stico completo (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An치lisis completado

  # ===== FIREBASE SAVINGS =====
  /api/v2/firebase/users/{usuario_id}/savings/goals:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: Metas de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Metas obtenidas

  /api/v2/firebase/users/{usuario_id}/savings/tips:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: Tips de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tips generados

  /api/v2/firebase/users/{usuario_id}/savings/budget-alerts:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: Alertas de presupuesto (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Alertas generadas

  /api/v2/firebase/users/{usuario_id}/savings/health-score:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: Puntuaci칩n de salud financiera (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Puntuaci칩n calculada

  /api/v2/firebase/users/{usuario_id}/savings/weekly-report:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: Reporte semanal (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Reporte generado

  /api/v2/firebase/users/{usuario_id}/savings/complete:
    get:
      tags:
        - 游댠 Firebase Savings
      summary: An치lisis completo de ahorro (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: An치lisis completado

  # ===== FIREBASE CHARTS =====
  /api/v2/firebase/users/{usuario_id}/charts/heatmap:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Heatmap de gastos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Heatmap generado

  /api/v2/firebase/users/{usuario_id}/charts/sankey:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Diagrama Sankey (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Diagrama generado

  /api/v2/firebase/users/{usuario_id}/charts/dashboard:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Dashboard interactivo (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Dashboard generado

  /api/v2/firebase/users/{usuario_id}/charts/comparison:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Comparaci칩n mensual (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comparaci칩n generada

  /api/v2/firebase/users/{usuario_id}/charts/export:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Exportar gr치ficos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr치ficos exportados

  /api/v2/firebase/users/{usuario_id}/charts/complete:
    get:
      tags:
        - 游댠 Firebase Charts
      summary: Todos los gr치ficos (usuario)
      security:
        - BearerAuth: []
        - ApiKeyAuth: []
      parameters:
        - name: usuario_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Gr치ficos generados